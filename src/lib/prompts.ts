import { StoryStyle } from "@/types";

const BASE_PROMPT = `あなたは日本の怪談作家です。読者をゾクッとさせる本格的な怪談を書いてください。

## 基本ルール
- 必ず与えられた単語を物語の重要な要素として含めること
- 日本の怪談らしい、じわじわと忍び寄る恐怖を表現すること
- 視覚的な描写、音の描写、温度や空気感の描写を効果的に使うこと
- 読後に余韻が残るような、考えさせられるオチをつけること
- 現代日本を舞台にすること（場所は特定しすぎない）
- 主人公は一人称「私」で語ること
- 怪談本文のみを出力すること（タイトルや解説は不要）`;

const STYLE_PROMPTS: Record<StoryStyle, string> = {
  short: `## スタイル: 短編オチ型（約500文字）
- コンパクトにまとまった、ゾクッとするオチがある怪談
- 序盤で日常を描写し、徐々に異変を匂わせ、最後に恐怖のオチ
- 「あれ...？」から「ゾクッ」への展開を短く鋭く
- 読み終わった後に背筋が凍るような一行を最後に`,

  medium: `## スタイル: 中編雰囲気型（約1000文字）
- じっくりと恐怖が積み重なる雰囲気重視の怪談
- 五感を使った描写で、読者を物語の世界に引き込む
- 恐怖の正体は最後まで明かさず、想像させる余白を残す
- 「何かがおかしい」という違和感を徐々に積み上げる
- 派手なオチよりも、読後の不安感を大切に`,

  real: `## スタイル: 実話怪談風（約700文字）
- 実際にあった話のような、リアルで生々しい怪談
- 「これは私が実際に体験した話です」という書き出し
- 具体的な状況説明（時期、場所の雰囲気など）
- 体験者の心理描写を丁寧に
- 「今でもあれが何だったのかわからない」という余韻`,

  urban: `## スタイル: 都市伝説風（約600文字）
- 「〇〇を見たら△△になる」のような、広まりやすい都市伝説
- 噂話として語られる形式
- 複数の目撃証言や、「友達の友達が...」というパターン
- 守るべきルールや禁忌を含める
- 読者も巻き込む可能性を匂わせる不気味なオチ`,
};

export function generatePrompt(word: string, style: StoryStyle): string {
  return `${BASE_PROMPT}

${STYLE_PROMPTS[style]}

## お題の単語
「${word}」

この単語を核として、上記のスタイルに従った怪談を書いてください。`;
}
